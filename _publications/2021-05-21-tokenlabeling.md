---
title: "All tokens matter: Token labeling for training better vision transformers"
collection: publications
permalink: /publication/2021-05-21-tokenlabeling
excerpt: 'Introduce a new token labeling objective for training better vision transformers.'
date: 2021-05-21
venue: 'NeurIPS'
paperurl: 'https://papers.nips.cc/paper/2021/file/9a49a25d845a483fae4be7e341368e36-Paper.pdf'
citation: 'Jiang, Zihang, et al. "All tokens matter: Token labeling for training better vision transformers." Thirty-Fifth Conference on Neural Information Processing Systems. 2021.'
---
In this paper, we present token labelingâ€”a new training objective for training high-performance vision transformers (ViTs). Different from the standard training objective of ViTs that computes the classification loss on an additional trainable class token, our proposed one takes advantage of all the image patch tokens to compute the training loss in a dense manner. Specifically, token labeling reformulates the image classification problem into multiple token-level recognition problems and assigns each patch token with an individual location-specific supervision generated by a machine annotator. Experiments show that token labeling can clearly and consistently improve the performance of various ViT models across a wide spectrum. For a vision transformer with 26M learnable parameters serving as an example, with token labeling, the model can achieve 84.4% Top-1 accuracy on ImageNet. The result can be further increased to 86.4% by slightly scaling the model size up to 150M, delivering the minimal-sized model among previous models (250M+) reaching 86%. We also show that token labeling can clearly improve the generalization capability of the pretrained models on downstream tasks with dense prediction, such as semantic segmentation. Our code and model are publicly available at https://github.com/zihangJiang/TokenLabeling.

[Download paper here](https://papers.nips.cc/paper/2021/file/9a49a25d845a483fae4be7e341368e36-Paper.pdf)
