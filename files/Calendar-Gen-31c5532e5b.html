<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>互动月历生成器</title>
    <script src="https://cdn.tailwindcss.com/3.3.3"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css">
    <style>
        body {
            font-family: 'Noto Sans SC', sans-serif;
            background: linear-gradient(135deg, #f5f7fa 0%, #e4edf5 100%);
            color: #2d3748;
            min-height: 100vh;
        }
        
        .calendar-container {
            max-width: 600px;
            margin: 0 auto;
        }
        
        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 8px;
        }
        
        .calendar-day {
            aspect-ratio: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 8px;
            transition: all 0.3s ease;
            cursor: pointer;
            font-weight: 500;
            position: relative;
            overflow: hidden;
        }
        
        .calendar-day.empty {
            background-color: rgba(255, 255, 255, 0.5);
            border: 2px dashed #e2e8f0;
        }
        
        .calendar-day.empty:hover {
            background-color: rgba(255, 255, 255, 0.8);
            border-color: #cbd5e0;
            transform: scale(1.05);
        }
        
        .calendar-day.filled {
            background-color: white;
            border: 1px solid #e2e8f0;
            position: relative;
        }
        
        .calendar-day.filled:hover {
            background-color: #f8fafc;
            transform: scale(1.05);
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }
        
        .calendar-day.selected {
            background-color: #4f46e5;
            color: white;
            border-color: #4f46e5;
        }
        
        .calendar-day.neighbor {
            background-color: rgba(79, 70, 229, 0.1);
            border: 1px solid rgba(79, 70, 229, 0.3);
        }
        
        .weekday-header {
            text-align: center;
            padding: 12px 0;
            font-weight: 600;
            color: #4a5568;
            background-color: rgba(255, 255, 255, 0.7);
            border-radius: 8px;
        }
        
        .btn-reset {
            transition: all 0.3s ease;
        }
        
        .btn-reset:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 15px -3px rgba(239, 68, 68, 0.3);
        }
        
        .btn-reset:active {
            transform: translateY(0);
        }
        
        .btn-generate {
            transition: all 0.3s ease;
        }
        
        .btn-generate:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 15px -3px rgba(79, 70, 229, 0.3);
        }
        
        .btn-generate:active {
            transform: translateY(0);
        }
        
        .glassmorphism {
            background: rgba(255, 255, 255, 0.7);
            backdrop-filter: blur(10px);
            border-radius: 16px;
            border: 1px solid rgba(255, 255, 255, 0.3);
            box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.15);
        }
        
        .blob {
            position: absolute;
            background: linear-gradient(135deg, #4299e1 0%, #9f7aea 100%);
            filter: blur(60px);
            opacity: 0.2;
            border-radius: 50%;
            animation: blob-movement 15s infinite linear;
            z-index: -1;
        }
        
        @keyframes blob-movement {
            0% { transform: translate(0, 0) scale(1); }
            33% { transform: translate(5%, -10%) scale(1.3); }
            66% { transform: translate(-15%, 5%) scale(0.9); }
            100% { transform: translate(0, 0) scale(1); }
        }
        
        .fade-in {
            animation: fadeIn 0.5s ease-in;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease, visibility 0.3s ease;
        }
        
        .modal.active {
            opacity: 1;
            visibility: visible;
        }
        
        .modal-content {
            background: white;
            padding: 2rem;
            border-radius: 12px;
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
            max-width: 400px;
            width: 90%;
            transform: translateY(-20px);
            transition: transform 0.3s ease;
        }
        
        .modal.active .modal-content {
            transform: translateY(0);
        }
        
        .input-date {
            width: 100%;
            padding: 0.75rem;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            font-size: 1rem;
            transition: border-color 0.3s ease;
        }
        
        .input-date:focus {
            outline: none;
            border-color: #4f46e5;
        }
        
        .error-message {
            color: #ef4444;
            font-size: 0.875rem;
            margin-top: 0.5rem;
            display: none;
        }
        
        .error-message.active {
            display: block;
        }
        
        .date-value {
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        
        .calendar-day.show-date .date-value {
            opacity: 1;
        }
        
        @media (max-width: 640px) {
            .calendar-grid {
                gap: 4px;
            }
            
            .calendar-day {
                font-size: 0.875rem;
            }
        }
    </style>
</head>
<body class="p-4 md:p-8">
    <div class="blob w-96 h-96 top-0 left-0"></div>
    <div class="blob w-80 h-80 bottom-0 right-0"></div>
    
    <div class="calendar-container">
        <header class="text-center mb-8">
            <h1 class="text-3xl md:text-4xl font-bold mb-2 bg-gradient-to-r from-indigo-600 to-purple-600 text-transparent bg-clip-text">
                互动月历生成器
            </h1>
            <p class="text-gray-600">输入任意日期，系统自动生成月历，点击格子显示对应日期</p>
        </header>
        
        <main class="glassmorphism p-6 md:p-8 mb-8">
            <div class="mb-6">
                <div class="calendar-grid mb-4">
                    <!-- 星期标题 -->
                    <div class="weekday-header">周日</div>
                    <div class="weekday-header">周一</div>
                    <div class="weekday-header">周二</div>
                    <div class="weekday-header">周三</div>
                    <div class="weekday-header">周四</div>
                    <div class="weekday-header">周五</div>
                    <div class="weekday-header">周六</div>
                </div>
                
                <!-- 日历格子 -->
                <div id="calendarDays" class="calendar-grid">
                    <!-- JavaScript 将动态生成这里的内容 -->
                </div>
            </div>
            
            <div class="flex justify-center">
                <button id="resetBtn" class="btn-reset bg-red-500 hover:bg-red-600 text-white font-semibold py-3 px-8 rounded-full flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed">
                    <i class="fas fa-redo-alt mr-2"></i> 重置
                </button>
            </div>
        </main>
        
        <!-- 生成月历按钮 -->
        <div class="text-center mb-12">
            <button id="generateBtn" class="btn-generate bg-indigo-600 hover:bg-indigo-700 text-white font-semibold py-3 px-8 rounded-full flex items-center justify-center mx-auto disabled:opacity-50 disabled:cursor-not-allowed">
                <i class="fas fa-calendar-alt mr-2"></i> 生成月历
            </button>
        </div>
    </div>
    
    <!-- 日期输入模态框 -->
    <div id="dateModal" class="modal">
        <div class="modal-content">
            <h3 class="text-xl font-semibold mb-4">输入日期</h3>
            <p class="text-gray-600 mb-4">请输入1-31之间的日期数字</p>
            <input type="number" id="dateInput" class="input-date" min="1" max="31" placeholder="输入日期">
            <p id="errorMessage" class="error-message">请输入1-31之间的有效数字</p>
            <div class="flex justify-end gap-3 mt-6">
                <button id="cancelBtn" class="px-4 py-2 bg-gray-200 hover:bg-gray-300 rounded-lg transition-colors">取消</button>
                <button id="confirmBtn" class="px-4 py-2 bg-indigo-600 hover:bg-indigo-700 text-white rounded-lg transition-colors">确认</button>
            </div>
        </div>
    </div>
    
    <footer class="mt-12 text-center text-gray-500 text-sm">
        <p>created by <a href="https://space.coze.cn" class="text-indigo-600 hover:underline">coze space</a></p>
        <p class="mt-1">页面内容均由 AI 生成，仅供参考</p>
    </footer>
    
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const calendarDays = document.getElementById('calendarDays');
            const resetBtn = document.getElementById('resetBtn');
            const generateBtn = document.getElementById('generateBtn');
            const dateModal = document.getElementById('dateModal');
            const dateInput = document.getElementById('dateInput');
            const confirmBtn = document.getElementById('confirmBtn');
            const cancelBtn = document.getElementById('cancelBtn');
            const errorMessage = document.getElementById('errorMessage');
            
            let firstDayIndex = -1;
            let selectedDayIndex = -1;
            let dayValues = new Map(); // 存储每个格子的日期值
            let isCalendarGenerated = false; // 标记月历是否已生成
            
            // 初始化日历格子
            function initializeCalendar() {
                calendarDays.innerHTML = '';
                dayValues.clear();
                isCalendarGenerated = false;
                
                // 创建42个格子（6周 * 7天）
                for (let i = 0; i < 42; i++) {
                    const dayElement = document.createElement('div');
                    dayElement.classList.add('calendar-day', 'empty');
                    dayElement.dataset.index = i;
                    
                    // 创建日期值容器
                    const dateValueElement = document.createElement('span');
                    dateValueElement.classList.add('date-value');
                    dayElement.appendChild(dateValueElement);
                    
                    dayElement.addEventListener('click', function() {
                        const index = parseInt(this.dataset.index);
                        
                        if (this.classList.contains('empty')) {
                            // 如果格子为空，显示模态框让用户输入日期
                            selectedDayIndex = index;
                            dateModal.classList.add('active');
                            dateInput.focus();
                        } else {
                            // 如果格子已有日期，切换显示/隐藏状态
                            this.classList.toggle('show-date');
                        }
                    });
                    
                    calendarDays.appendChild(dayElement);
                }
                
                // 禁用重置按钮和生成月历按钮
                resetBtn.disabled = true;
                generateBtn.disabled = true;
            }
            
            // 验证日期输入
            function validateDate(date) {
                const num = parseInt(date);
                return !isNaN(num) && num >= 1 && num <= 31;
            }
            
            // 生成整个月历
            function generateFullCalendar(selectedIndex, selectedDate) {
                // 清空所有格子的日期值
                dayValues.clear();
                
                // 计算每个格子的日期
                for (let i = 0; i < 42; i++) {
                    const dayDiff = i - selectedIndex;
                    const dayValue = selectedDate + dayDiff;
                    
                    // 确保日期在1-31范围内
                    if (dayValue >= 1 && dayValue <= 31) {
                        dayValues.set(i, dayValue);
                        
                        const dayElement = document.querySelector(`.calendar-day[data-index="${i}"]`);
                        dayElement.querySelector('.date-value').textContent = dayValue.toString();
                        dayElement.classList.remove('empty');
                        dayElement.classList.add('filled');
                        
                        // 如果是1号，设置为锁定位置
                        if (dayValue === 1) {
                            firstDayIndex = i;
                            
                            // 移除之前的锁定位置
                            document.querySelectorAll('.calendar-day').forEach(day => {
                                day.classList.remove('selected');
                            });
                            
                            dayElement.classList.add('selected');
                        }
                    } else {
                        // 超出范围的日期保持为空
                        const dayElement = document.querySelector(`.calendar-day[data-index="${i}"]`);
                        dayElement.classList.remove('filled', 'selected', 'neighbor');
                        dayElement.classList.add('empty');
                        dayElement.querySelector('.date-value').textContent = '';
                    }
                }
                
                isCalendarGenerated = true;
                resetBtn.disabled = false;
                generateBtn.disabled = false;
            }
            
            // 显示全部月历日期
            function showAllDates() {
                if (isCalendarGenerated) {
                    document.querySelectorAll('.calendar-day.filled').forEach(day => {
                        day.classList.add('show-date');
                    });
                }
            }
            
            // 重置日历
            function resetCalendar() {
                firstDayIndex = -1;
                selectedDayIndex = -1;
                initializeCalendar();
            }
            
            // 绑定重置按钮事件
            resetBtn.addEventListener('click', resetCalendar);
            
            // 绑定生成月历按钮事件
            generateBtn.addEventListener('click', showAllDates);
            
            // 绑定模态框确认按钮事件
            confirmBtn.addEventListener('click', function() {
                const date = dateInput.value.trim();
                
                if (validateDate(date)) {
                    // 隐藏错误消息
                    errorMessage.classList.remove('active');
                    
                    // 填充选中的日期
                    const selectedDay = document.querySelector(`.calendar-day[data-index="${selectedDayIndex}"]`);
                    const dayNum = parseInt(date);
                    
                    // 生成整个月历
                    generateFullCalendar(selectedDayIndex, dayNum);
                    
                    // 关闭模态框
                    dateModal.classList.remove('active');
                    dateInput.value = '';
                } else {
                    // 显示错误消息
                    errorMessage.classList.add('active');
                }
            });
            
            // 绑定模态框取消按钮事件
            cancelBtn.addEventListener('click', function() {
                // 隐藏错误消息
                errorMessage.classList.remove('active');
                
                // 关闭模态框
                dateModal.classList.remove('active');
                dateInput.value = '';
            });
            
            // 点击模态框外部关闭模态框
            dateModal.addEventListener('click', function(e) {
                if (e.target === dateModal) {
                    // 隐藏错误消息
                    errorMessage.classList.remove('active');
                    
                    // 关闭模态框
                    dateModal.classList.remove('active');
                    dateInput.value = '';
                }
            });
            
            // 按ESC键关闭模态框
            document.addEventListener('keydown', function(e) {
                if (e.key === 'Escape' && dateModal.classList.contains('active')) {
                    // 隐藏错误消息
                    errorMessage.classList.remove('active');
                    
                    // 关闭模态框
                    dateModal.classList.remove('active');
                    dateInput.value = '';
                }
                
                // 按Enter键确认输入
                if (e.key === 'Enter' && dateModal.classList.contains('active')) {
                    confirmBtn.click();
                }
            });
            
            // 初始化日历
            initializeCalendar();
        });
    </script>
</body>
</html>
